<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>shinychord by ijlyttle</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-light.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1 class="header">shinychord</h1>
        <p class="header">Reusable shiny modules</p>

        <ul>
          <li class="download"><a class="buttons" href="https://github.com/ijlyttle/shinychord/zipball/master">Download ZIP</a></li>
          <li class="download"><a class="buttons" href="https://github.com/ijlyttle/shinychord/tarball/master">Download TAR</a></li>
          <li><a class="buttons github" href="https://github.com/ijlyttle/shinychord">View On GitHub</a></li>
        </ul>

        <p class="header">This project is maintained by <a class="header name" href="https://github.com/ijlyttle">ijlyttle</a></p>


      </header>
      <section>
        <h1>
<a id="shinychord" class="anchor" href="#shinychord" aria-hidden="true"><span class="octicon octicon-link"></span></a>shinychord</h1>

<p>The purpose of this package is to propose a convention for reusable shiny modules.</p>

<p>This might be useful for shiny code where:</p>

<ul>
<li>things can be broken down into modules</li>
<li>within each module, the are a lot of controls are important only within the module</li>
<li>there may be a need to use modules in different apps</li>
</ul>

<p>One benefit is that the server logic for a given module is encapsulated, while exposing only a few reactive values and the ui elements.</p>

<h2>
<a id="tldr" class="anchor" href="#tldr" aria-hidden="true"><span class="octicon octicon-link"></span></a>tl;dr</h2>

<ul>
<li><p><a href="https://ijlyttle.github.io/shinychord/doc/isu_presentation.pdf">PDF of a presentation</a> made to the ISU Statistics Graphics Group - 2015-10-01. Revised 2015-10-05.</p></li>
<li><p><a href="https://ijlyttle.shinyapps.io/shinychord_dygraphs">Demonstration app</a>, showing a <a href="https://rstudio.github.io/dygraphs/">dygraph</a> shinychord in a shiny-app.</p></li>
<li><p><a href="https://ijlyttle.shinyapps.io/shinychord_readr_dygraphs">Demonstration app</a>, showing a <a href="https://github.com/hadley/readr">csv-parser</a> shinychord and a <a href="https://rstudio.github.io/dygraphs/">dygraph</a> shinychord in a shiny app.</p></li>
</ul>

<h2>
<a id="structure-of-a-shinychord" class="anchor" href="#structure-of-a-shinychord" aria-hidden="true"><span class="octicon octicon-link"></span></a>Structure of a shinychord</h2>

<p>A shinychord is simply a function that takes <code>id</code> as its argument. It returns a list with three items:</p>

<ul>
<li>
<code>ui_controller</code> a <code>shiny::tagList</code> containing ui elements focusing on inputs</li>
<li>
<code>ui_view</code> a <code>shiny::tagList</code> containing ui elements focusing on outputs</li>
<li>
<code>server_model</code> a function that contains all the server logic, and exposes reactive values</li>
</ul>

<p>As you might imagine, the names on this list are inspired by the model-view-controller paradigm.</p>

<p>There is nothing mandatory or scared about the names of these elements, it is only a proposed convention. Furthermore, the elements of each <code>shiny::taglist</code> are available if you want to select or arrange them differently.</p>

<h2>
<a id="example" class="anchor" href="#example" aria-hidden="true"><span class="octicon octicon-link"></span></a>Example</h2>

<p>Let's say we wanted a shinychord to upload and parse a delimited file. We start with a template for a shinychord:</p>

<div class="highlight highlight-source-r"><pre><span class="pl-en">ch_upload_parse</span> <span class="pl-k">&lt;-</span> <span class="pl-k">function</span>(<span class="pl-smi">id</span>){

  <span class="pl-c"># controller</span>
  <span class="pl-smi">ui_controller</span> <span class="pl-k">&lt;-</span> <span class="pl-e">shiny</span><span class="pl-k">::</span>tagList()

  <span class="pl-c"># view</span>
  <span class="pl-smi">ui_view</span> <span class="pl-k">&lt;-</span> <span class="pl-e">shiny</span><span class="pl-k">::</span>tagList()

  <span class="pl-c"># model</span>
  <span class="pl-en">server_model</span> <span class="pl-k">&lt;-</span> <span class="pl-k">function</span>(
    <span class="pl-smi">input</span>, <span class="pl-smi">output</span>, <span class="pl-smi">session</span>
  ){

  }

  <span class="pl-k">list</span>(
    <span class="pl-v">ui_controller</span> <span class="pl-k">=</span> <span class="pl-smi">ui_controller</span>,
    <span class="pl-v">ui_view</span> <span class="pl-k">=</span> <span class="pl-smi">ui_view</span>,
    <span class="pl-v">server_model</span> <span class="pl-k">=</span> <span class="pl-smi">server_model</span>
  )
}</pre></div>

<p>Over the next few sections, we show how the parts of the template are filled out so that we end with a complete shinychord.</p>

<h3>
<a id="naming-function" class="anchor" href="#naming-function" aria-hidden="true"><span class="octicon octicon-link"></span></a>Naming function</h3>

<p>One of the challenges we have in composing shiny applications is a way to keep the names unique among each of the elements.</p>

<p>To help us, I put a function at the top of the shinychord:</p>

<div class="highlight highlight-source-r"><pre><span class="pl-en">id_name</span> <span class="pl-k">&lt;-</span> <span class="pl-k">function</span>(<span class="pl-k">...</span>){
  paste(<span class="pl-k">list</span>(<span class="pl-smi">id</span>, <span class="pl-k">...</span>), <span class="pl-v">collapse</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>_<span class="pl-pds">"</span></span>)
}</pre></div>

<p>This function will be very handy as we define the inputs and outputs.</p>

<h3>
<a id="controller" class="anchor" href="#controller" aria-hidden="true"><span class="octicon octicon-link"></span></a>Controller</h3>

<p>We could make this as fancy as we like, but let's consider a simple set of controls, comprised of a file-upload input and a select input (to choose a delimiter)</p>

<div class="highlight highlight-source-r"><pre><span class="pl-smi">ui_controller</span> <span class="pl-k">&lt;-</span> <span class="pl-e">shiny</span><span class="pl-k">::</span>tagList()

<span class="pl-smi">id_controller_file</span> <span class="pl-k">&lt;-</span> id_name(<span class="pl-s"><span class="pl-pds">"</span>controller<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>file<span class="pl-pds">"</span></span>)
<span class="pl-smi">ui_controller</span><span class="pl-k">$</span><span class="pl-smi">file</span> <span class="pl-k">&lt;-</span>
  <span class="pl-e">shiny</span><span class="pl-k">::</span>fileInput(
    <span class="pl-v">inputId</span> <span class="pl-k">=</span> <span class="pl-smi">id_controller_file</span>,
    <span class="pl-v">label</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>File<span class="pl-pds">"</span></span>,
    <span class="pl-v">accept</span> <span class="pl-k">=</span> c(<span class="pl-s"><span class="pl-pds">"</span>text/csv<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>.csv<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>text/comma-separated-values<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>text/plain<span class="pl-pds">"</span></span>)
  )</pre></div>

<p>You can see that we use the <code>id_name()</code> function to combine the <code>id</code> string (supplied as an
argument to the shiny chord) with the local identifier.</p>

<p>We also want an input to choose the delimiter:</p>

<div class="highlight highlight-source-r"><pre><span class="pl-smi">id_controller_delim</span> <span class="pl-k">&lt;-</span> id_name(<span class="pl-s"><span class="pl-pds">"</span>controller<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>delim<span class="pl-pds">"</span></span>)
<span class="pl-smi">ui_controller</span><span class="pl-k">$</span><span class="pl-smi">delim</span> <span class="pl-k">&lt;-</span>
  <span class="pl-e">shiny</span><span class="pl-k">::</span>selectizeInput(
    <span class="pl-v">inputId</span> <span class="pl-k">=</span> <span class="pl-smi">id_controller_delim</span>,
    <span class="pl-v">label</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>Delimiter<span class="pl-pds">"</span></span>,
    <span class="pl-v">choices</span> <span class="pl-k">=</span> c(<span class="pl-v">Comma</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>,<span class="pl-pds">"</span></span>, <span class="pl-v">Semicolon</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>;<span class="pl-pds">"</span></span>, <span class="pl-v">Tab</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-cce">\t</span><span class="pl-pds">"</span></span>),
    <span class="pl-v">selected</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>;<span class="pl-pds">"</span></span>
  )</pre></div>

<h3>
<a id="view" class="anchor" href="#view" aria-hidden="true"><span class="octicon octicon-link"></span></a>View</h3>

<p>We will want a couple of view elements - one to preview the text that has been uploaded, and another to preview the parsed dataframe.</p>

<div class="highlight highlight-source-r"><pre><span class="pl-smi">ui_view</span> <span class="pl-k">&lt;-</span> <span class="pl-e">shiny</span><span class="pl-k">::</span>tagList()

<span class="pl-c"># shows the raw text of the file (first few lines)</span>
<span class="pl-smi">id_view_text</span> <span class="pl-k">&lt;-</span> id_name(<span class="pl-s"><span class="pl-pds">"</span>view<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>text<span class="pl-pds">"</span></span>)
<span class="pl-smi">ui_view</span><span class="pl-k">$</span><span class="pl-smi">text</span> <span class="pl-k">&lt;-</span> <span class="pl-e">shiny</span><span class="pl-k">::</span>verbatimTextOutput(<span class="pl-smi">id_view_text</span>)

<span class="pl-c"># shows a glimpse of the parsed data-frame</span>
<span class="pl-smi">id_view_data</span> <span class="pl-k">&lt;-</span> id_name(<span class="pl-s"><span class="pl-pds">"</span>view<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>data<span class="pl-pds">"</span></span>)
<span class="pl-smi">ui_view</span><span class="pl-k">$</span><span class="pl-smi">data</span> <span class="pl-k">&lt;-</span> <span class="pl-e">shiny</span><span class="pl-k">::</span>verbatimTextOutput(<span class="pl-smi">id_view_data</span>)</pre></div>

<h3>
<a id="model" class="anchor" href="#model" aria-hidden="true"><span class="octicon octicon-link"></span></a>Model</h3>

<p>A couple of notes here:</p>

<ul>
<li><p>Whenever we refer to a reactive value, we have to wrap it in a reactive expression.</p></li>
<li><p>For this shinychord, the ultimate goal is to encapsulate the details so that we expose an <code>id</code>, when we create the shinychord, and a reactive value, when we place the <code>server_model()</code> function in the shiny <code>server()</code> function. We have to pass to this <code>server_model()</code> function the reactive value and the name of the item within the reactive value. It will be in this reactive value that the parsed dataframe will be placed.</p></li>
</ul>

<div class="highlight highlight-source-r"><pre><span class="pl-en">server_model</span> <span class="pl-k">&lt;-</span> <span class="pl-k">function</span>(
  <span class="pl-smi">input</span>, <span class="pl-smi">output</span>, <span class="pl-smi">session</span>,
  <span class="pl-smi">rctval_data</span>, <span class="pl-smi">item_data</span>
){

  <span class="pl-c">## reactives</span>

  <span class="pl-c"># reactive to read in the raw text from the file-specification input</span>
  <span class="pl-smi">rct_txt</span> <span class="pl-k">&lt;-</span> reactive({

    <span class="pl-e">shiny</span><span class="pl-k">::</span>validate(
      <span class="pl-e">shiny</span><span class="pl-k">::</span>need(<span class="pl-smi">env</span><span class="pl-k">$</span><span class="pl-smi">input</span>[[<span class="pl-smi">id_controller_file</span>]], <span class="pl-s"><span class="pl-pds">"</span>File not selected<span class="pl-pds">"</span></span>)
    )

    <span class="pl-smi">infile</span> <span class="pl-k">&lt;-</span> <span class="pl-smi">input</span>[[<span class="pl-smi">id_controller_file</span>]]<span class="pl-k">$</span><span class="pl-smi">datapath</span>

    <span class="pl-e">readr</span><span class="pl-k">::</span>read_file(<span class="pl-smi">infile</span>)
  })

  <span class="pl-c">## observers</span>

  <span class="pl-c"># this needs to be wrapped in a reactive expression</span>
  observe({
    <span class="pl-smi">rctval_data</span>[[<span class="pl-smi">item_data</span>]] <span class="pl-k">&lt;-</span>
      <span class="pl-e">readr</span><span class="pl-k">::</span>read_delim(
        <span class="pl-v">file</span> <span class="pl-k">=</span> rct_txt(),
        <span class="pl-v">delim</span> <span class="pl-k">=</span> <span class="pl-smi">input</span>[[<span class="pl-smi">id_controller_delim</span>]]
      )
  })

  <span class="pl-c">## outputs</span>

  <span class="pl-c"># sets the output for the raw text</span>
  <span class="pl-smi">output</span>[[<span class="pl-smi">id_view_text</span>]] <span class="pl-k">&lt;-</span>
    renderText({

      <span class="pl-e">shiny</span><span class="pl-k">::</span>validate(
        <span class="pl-e">shiny</span><span class="pl-k">::</span>need(rct_txt(), <span class="pl-s"><span class="pl-pds">"</span>File did not load properly<span class="pl-pds">"</span></span>)
      )

      <span class="pl-smi">h</span> <span class="pl-k">&lt;-</span> rct_txt()
      <span class="pl-smi">h</span> <span class="pl-k">&lt;-</span> <span class="pl-e">readr</span><span class="pl-k">::</span>read_lines(<span class="pl-smi">h</span>, <span class="pl-v">n_max</span> <span class="pl-k">=</span> <span class="pl-c1">10</span>)

      paste(<span class="pl-smi">h</span>, <span class="pl-v">collapse</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-cce">\n</span><span class="pl-pds">"</span></span>)
    })


  <span class="pl-c"># sets the output for the parsed dataframe</span>
  <span class="pl-smi">output</span>[[<span class="pl-smi">id_view_data</span>]] <span class="pl-k">&lt;-</span>
    renderPrint({

      <span class="pl-e">shiny</span><span class="pl-k">::</span>validate(
        <span class="pl-e">shiny</span><span class="pl-k">::</span>need(<span class="pl-smi">rctval_data</span>[[<span class="pl-smi">item_data</span>]], <span class="pl-s"><span class="pl-pds">"</span>No data<span class="pl-pds">"</span></span>)
      )

      <span class="pl-e">dplyr</span><span class="pl-k">::</span>glimpse(<span class="pl-smi">rctval_data</span>[[<span class="pl-smi">item_data</span>]])
    })

}</pre></div>

<h2>
<a id="completed-shinychord" class="anchor" href="#completed-shinychord" aria-hidden="true"><span class="octicon octicon-link"></span></a>Completed shinychord</h2>

<p>So here are all the elements from above, combined into a shinychord function:</p>

<div class="highlight highlight-source-r"><pre><span class="pl-en">ch_upload_parse</span> <span class="pl-k">&lt;-</span> <span class="pl-k">function</span>(<span class="pl-smi">id</span>){

  <span class="pl-en">id_name</span> <span class="pl-k">&lt;-</span> <span class="pl-k">function</span>(<span class="pl-k">...</span>){
    paste(<span class="pl-k">list</span>(<span class="pl-smi">id</span>, <span class="pl-k">...</span>), <span class="pl-v">collapse</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>_<span class="pl-pds">"</span></span>)
  }

  <span class="pl-c"># controller</span>
  <span class="pl-smi">ui_controller</span> <span class="pl-k">&lt;-</span> <span class="pl-e">shiny</span><span class="pl-k">::</span>tagList()

  <span class="pl-smi">id_controller_file</span> <span class="pl-k">&lt;-</span> id_name(<span class="pl-s"><span class="pl-pds">"</span>controller<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>file<span class="pl-pds">"</span></span>)
  <span class="pl-smi">ui_controller</span><span class="pl-k">$</span><span class="pl-smi">file</span> <span class="pl-k">&lt;-</span>
    <span class="pl-e">shiny</span><span class="pl-k">::</span>fileInput(
      <span class="pl-v">inputId</span> <span class="pl-k">=</span> <span class="pl-smi">id_controller_file</span>,
      <span class="pl-v">label</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>File<span class="pl-pds">"</span></span>,
      <span class="pl-v">accept</span> <span class="pl-k">=</span> c(<span class="pl-s"><span class="pl-pds">"</span>text/csv<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>.csv<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>text/comma-separated-values<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>text/plain<span class="pl-pds">"</span></span>)
    )

  <span class="pl-smi">id_controller_delim</span> <span class="pl-k">&lt;-</span> id_name(<span class="pl-s"><span class="pl-pds">"</span>controller<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>delim<span class="pl-pds">"</span></span>)
  <span class="pl-smi">ui_controller</span><span class="pl-k">$</span><span class="pl-smi">delim</span> <span class="pl-k">&lt;-</span>
    <span class="pl-e">shiny</span><span class="pl-k">::</span>selectizeInput(
      <span class="pl-v">inputId</span> <span class="pl-k">=</span> <span class="pl-smi">id_controller_delim</span>,
      <span class="pl-v">label</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>Delimiter<span class="pl-pds">"</span></span>,
      <span class="pl-v">choices</span> <span class="pl-k">=</span> c(<span class="pl-v">Comma</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>,<span class="pl-pds">"</span></span>, <span class="pl-v">Semicolon</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>;<span class="pl-pds">"</span></span>, <span class="pl-v">Tab</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-cce">\t</span><span class="pl-pds">"</span></span>),
      <span class="pl-v">selected</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>;<span class="pl-pds">"</span></span>
    )

  <span class="pl-c"># view</span>
  <span class="pl-smi">ui_view</span> <span class="pl-k">&lt;-</span> <span class="pl-e">shiny</span><span class="pl-k">::</span>tagList()

  <span class="pl-c"># shows the raw text of the file (first few lines)</span>
  <span class="pl-smi">id_view_text</span> <span class="pl-k">&lt;-</span> id_name(<span class="pl-s"><span class="pl-pds">"</span>view<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>text<span class="pl-pds">"</span></span>)
  <span class="pl-smi">ui_view</span><span class="pl-k">$</span><span class="pl-smi">text</span> <span class="pl-k">&lt;-</span> <span class="pl-e">shiny</span><span class="pl-k">::</span>verbatimTextOutput(<span class="pl-smi">id_view_text</span>)

  <span class="pl-c"># shows a glimpse of the parsed data-frame</span>
  <span class="pl-smi">id_view_data</span> <span class="pl-k">&lt;-</span> id_name(<span class="pl-s"><span class="pl-pds">"</span>view<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>data<span class="pl-pds">"</span></span>)
  <span class="pl-smi">ui_view</span><span class="pl-k">$</span><span class="pl-smi">data</span> <span class="pl-k">&lt;-</span> <span class="pl-e">shiny</span><span class="pl-k">::</span>verbatimTextOutput(<span class="pl-smi">id_view_data</span>)

  <span class="pl-c"># model</span>
<span class="pl-en">server_model</span> <span class="pl-k">&lt;-</span> <span class="pl-k">function</span>(
  <span class="pl-smi">input</span>, <span class="pl-smi">output</span>, <span class="pl-smi">session</span>,
  <span class="pl-smi">rctval_data</span>, <span class="pl-smi">item_data</span>
){

  <span class="pl-c">## reactives</span>

  <span class="pl-c"># reactive to read in the raw text from the file-specification input</span>
  <span class="pl-smi">rct_txt</span> <span class="pl-k">&lt;-</span> reactive({

    <span class="pl-e">shiny</span><span class="pl-k">::</span>validate(
      <span class="pl-e">shiny</span><span class="pl-k">::</span>need(<span class="pl-smi">input</span>[[<span class="pl-smi">id_controller_file</span>]], <span class="pl-s"><span class="pl-pds">"</span>File not selected<span class="pl-pds">"</span></span>)
    )

    <span class="pl-smi">infile</span> <span class="pl-k">&lt;-</span> <span class="pl-smi">input</span>[[<span class="pl-smi">id_controller_file</span>]]<span class="pl-k">$</span><span class="pl-smi">datapath</span>

    <span class="pl-e">readr</span><span class="pl-k">::</span>read_file(<span class="pl-smi">infile</span>)
  })

  <span class="pl-c">## observers</span>

  <span class="pl-c"># this needs to be wrapped in a reactive expression</span>
  observe({
    <span class="pl-smi">rctval_data</span>[[<span class="pl-smi">item_data</span>]] <span class="pl-k">&lt;-</span>
      <span class="pl-e">readr</span><span class="pl-k">::</span>read_delim(
        <span class="pl-v">file</span> <span class="pl-k">=</span> rct_txt(),
        <span class="pl-v">delim</span> <span class="pl-k">=</span> <span class="pl-smi">input</span>[[<span class="pl-smi">id_controller_delim</span>]]
      )
  })

  <span class="pl-c">## outputs</span>

  <span class="pl-c"># sets the output for the raw text</span>
  <span class="pl-smi">output</span>[[<span class="pl-smi">id_view_text</span>]] <span class="pl-k">&lt;-</span>
    renderText({

      <span class="pl-e">shiny</span><span class="pl-k">::</span>validate(
        <span class="pl-e">shiny</span><span class="pl-k">::</span>need(rct_txt(), <span class="pl-s"><span class="pl-pds">"</span>File did not load properly<span class="pl-pds">"</span></span>)
      )

      <span class="pl-smi">h</span> <span class="pl-k">&lt;-</span> rct_txt()
      <span class="pl-smi">h</span> <span class="pl-k">&lt;-</span> <span class="pl-e">readr</span><span class="pl-k">::</span>read_lines(<span class="pl-smi">h</span>, <span class="pl-v">n_max</span> <span class="pl-k">=</span> <span class="pl-c1">10</span>)

      paste(<span class="pl-smi">h</span>, <span class="pl-v">collapse</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-cce">\n</span><span class="pl-pds">"</span></span>)
    })


  <span class="pl-c"># sets the output for the parsed dataframe</span>
  <span class="pl-smi">output</span>[[<span class="pl-smi">id_view_data</span>]] <span class="pl-k">&lt;-</span>
    renderPrint({

      <span class="pl-e">shiny</span><span class="pl-k">::</span>validate(
        <span class="pl-e">shiny</span><span class="pl-k">::</span>need(<span class="pl-smi">rctval_data</span>[[<span class="pl-smi">item_data</span>]], <span class="pl-s"><span class="pl-pds">"</span>No data<span class="pl-pds">"</span></span>)
      )

      <span class="pl-e">dplyr</span><span class="pl-k">::</span>glimpse(<span class="pl-smi">rctval_data</span>[[<span class="pl-smi">item_data</span>]])
    })

}  
  <span class="pl-k">list</span>(
    <span class="pl-v">ui_controller</span> <span class="pl-k">=</span> <span class="pl-smi">ui_controller</span>,
    <span class="pl-v">ui_view</span> <span class="pl-k">=</span> <span class="pl-smi">ui_view</span>,
    <span class="pl-v">server_model</span> <span class="pl-k">=</span> <span class="pl-smi">server_model</span>
  )
}</pre></div>

<h3>
<a id="using-the-shinychord-in-an-app" class="anchor" href="#using-the-shinychord-in-an-app" aria-hidden="true"><span class="octicon octicon-link"></span></a>Using the shinychord in an app</h3>

<p>Here's where we can see a benefit of this approach, as all the interal complexity of the shinychord has been encapuslated, exposing only the bits we need.</p>

<p>For the shiny developer, instead of developing a file-parser for every occasion, or cutting and pasting from a template (and managing the id's), she or he can use a shinychord - set an <code>id</code> in one place, and create a reactive value into which the <code>server_model</code> function can leave the resulting dataframe.</p>

<p>The shinychord function can be created once and used everywhere.</p>

<div class="highlight highlight-source-r"><pre>library(<span class="pl-s"><span class="pl-pds">"</span>shiny<span class="pl-pds">"</span></span>)
library(<span class="pl-s"><span class="pl-pds">"</span>readr<span class="pl-pds">"</span></span>)
library(<span class="pl-s"><span class="pl-pds">"</span>dplyr<span class="pl-pds">"</span></span>)

<span class="pl-smi">chord_parse</span> <span class="pl-k">&lt;-</span> ch_upload_parse(<span class="pl-s"><span class="pl-pds">"</span>parse<span class="pl-pds">"</span></span>)

shinyApp(

  <span class="pl-v">ui</span> <span class="pl-k">=</span> fluidPage(
    sidebarLayout(
      sidebarPanel(<span class="pl-smi">chord_parse</span><span class="pl-k">$</span><span class="pl-smi">ui_controller</span>),
      mainPanel(<span class="pl-smi">chord_parse</span><span class="pl-k">$</span><span class="pl-smi">ui_view</span>)
    )
  ),

  <span class="pl-v">server</span> <span class="pl-k">=</span> <span class="pl-k">function</span>(<span class="pl-smi">input</span>, <span class="pl-smi">output</span>, <span class="pl-smi">session</span>){

    <span class="pl-smi">rctval</span> <span class="pl-k">&lt;-</span> reactiveValues(<span class="pl-v">data_csv</span> <span class="pl-k">=</span> <span class="pl-c1">NULL</span>)

    <span class="pl-smi">chord_parse</span><span class="pl-k">$</span>server_model(
      <span class="pl-smi">input</span>, <span class="pl-smi">output</span>, <span class="pl-smi">session</span>,
      <span class="pl-v">rctval_data</span> <span class="pl-k">=</span> <span class="pl-smi">rctval</span>, <span class="pl-v">item_data</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>data_csv<span class="pl-pds">"</span></span>
    )

    observe(print(<span class="pl-smi">rctval</span><span class="pl-k">$</span><span class="pl-smi">data_csv</span>))

  }

)</pre></div>
      </section>
      <footer>
        <p><small>Hosted on <a href="https://pages.github.com">GitHub Pages</a> using the Dinky theme</small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
		
  </body>
</html>
